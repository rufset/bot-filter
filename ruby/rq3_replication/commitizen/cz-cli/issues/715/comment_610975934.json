{
  "_id": {
    "$oid": "60725fa543dd71267de413a4"
  },
  "author_association": "MEMBER",
  "issue_url": "https://api.github.com/repos/commitizen/cz-cli/issues/715",
  "updated_at": "2020-04-08T13:58:58Z",
  "performed_via_github_app": null,
  "html_url": "https://github.com/commitizen/cz-cli/issues/715#issuecomment-610975934",
  "created_at": "2020-04-08T13:57:59Z",
  "id": 610975934,
  "body": "@bajtos https://dev.azure.com/commitizen/cbf3c633-a6bc-43ce-ae50-fe434d244768/_apis/build/builds/851/logs/50 is the current error I am working through.  For some reason windows fails with a ShellJS internal error, something about permissions on package.json. Not sure why it is failing on windows.\r\n\r\n```\r\n2020-04-07T20:05:12.6606024Z ##[section]Starting: CmdLine\r\n2020-04-07T20:05:12.6709426Z ==============================================================================\r\n2020-04-07T20:05:12.6710031Z Task         : Command line\r\n2020-04-07T20:05:12.6710497Z Description  : Run a command line script using Bash on Linux and macOS and cmd.exe on Windows\r\n2020-04-07T20:05:12.6710951Z Version      : 2.164.0\r\n2020-04-07T20:05:12.6711304Z Author       : Microsoft Corporation\r\n2020-04-07T20:05:12.6711767Z Help         : https://docs.microsoft.com/azure/devops/pipelines/tasks/utility/command-line\r\n2020-04-07T20:05:12.6712303Z ==============================================================================\r\n2020-04-07T20:05:13.4903228Z Generating script.\r\n2020-04-07T20:05:13.4998081Z Script contents:\r\n2020-04-07T20:05:13.5004561Z npm test && npm run write-coverage\r\n2020-04-07T20:05:13.5342796Z ========================== Starting Command Output ===========================\r\n2020-04-07T20:05:13.5594528Z ##[command]\"C:\\windows\\system32\\cmd.exe\" /D /E:ON /V:OFF /S /C \"CALL \"d:\\a\\_temp\\199dae85-2615-4a37-b23e-df12c3bfbf06.cmd\"\"\r\n2020-04-07T20:05:14.1913196Z \r\n2020-04-07T20:05:14.1914622Z > commitizen@0.0.0-semantically-released test D:\\a\\1\\s\r\n2020-04-07T20:05:14.1915461Z > nyc --require @babel/register npm run test-actual\r\n2020-04-07T20:05:14.1916016Z \r\n2020-04-07T20:05:15.3964071Z \r\n2020-04-07T20:05:15.3965137Z > commitizen@0.0.0-semantically-released test-actual D:\\a\\1\\s\r\n2020-04-07T20:05:15.3965759Z > mocha --reporter=mocha-multi-reporters --reporter-options configFile=./test/mochareporters.json test/tests/index.js\r\n2020-04-07T20:05:15.3966205Z \r\n2020-04-07T20:05:20.3482640Z \r\n2020-04-07T20:05:20.3491540Z \r\n2020-04-07T20:05:20.3580345Z   adapter\r\n2020-04-07T20:05:45.2251196Z     âˆš resolves adapter paths (20284ms)\r\n2020-04-07T20:06:03.6470506Z     âˆš resolves scoped adapter paths (3240ms)\r\n2020-04-07T20:06:40.1738702Z [BABEL] Note: The code generator has deoptimised the styling of D:\\a\\1\\s\\test\\.tmp\\enduser-app\\node_modules\\lodash\\lodash.js as it exceeds the max of 500KB.\r\n2020-04-07T20:06:43.9848780Z     âˆš gets adapter prompter functions (31718ms)\r\n2020-04-07T20:06:50.5327645Z ShellJS: internal error\r\n2020-04-07T20:06:50.5410420Z Error: EPERM: operation not permitted, lstat 'D:/a/1/s/test/.tmp/enduser-app/package.json'\r\n2020-04-07T20:06:50.5412145Z     at Object.lstatSync (fs.js:923:3)\r\n2020-04-07T20:06:50.5412996Z     at rmdirSyncRecursive (D:\\a\\1\\s\\node_modules\\shelljs\\src\\rm.js:28:23)\r\n2020-04-07T20:06:50.5414175Z     at D:\\a\\1\\s\\node_modules\\shelljs\\src\\rm.js:136:9\r\n2020-04-07T20:06:50.5414922Z     at Array.forEach (<anonymous>)\r\n2020-04-07T20:06:50.5415566Z     at Object._rm (D:\\a\\1\\s\\node_modules\\shelljs\\src\\rm.js:113:9)\r\n2020-04-07T20:06:50.5416273Z     at Object.rm (D:\\a\\1\\s\\node_modules\\shelljs\\src\\common.js:365:25)\r\n2020-04-07T20:06:50.5416954Z     at rm (D:\\a\\1\\s\\test\\tools/clean.js:119:6)\r\n2020-04-07T20:06:50.5417990Z     at Object.cleanPath (D:\\a\\1\\s\\test\\tools/clean.js:24:3)\r\n2020-04-07T20:06:50.5418725Z     at Context.afterEach (D:\\a\\1\\s\\test\\tests/commit.js:319:9)\r\n2020-04-07T20:06:50.5420922Z     at callFn (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runnable.js:387:21)\r\n2020-04-07T20:06:50.5421986Z     at Hook.Runnable.run (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runnable.js:379:7)\r\n2020-04-07T20:06:50.5422674Z     at next (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runner.js:384:10)\r\n2020-04-07T20:06:50.5423314Z     at D:\\a\\1\\s\\node_modules\\mocha\\lib\\runner.js:420:7\r\n2020-04-07T20:06:50.5425129Z     at done (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runnable.js:334:5)\r\n2020-04-07T20:06:50.5426600Z     at callFn (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runnable.js:410:7)\r\n2020-04-07T20:06:50.5427456Z     at Hook.Runnable.run (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runnable.js:379:7)\r\n2020-04-07T20:06:50.5428281Z     at next (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runner.js:384:10)\r\n2020-04-07T20:06:50.5429308Z     at Immediate._onImmediate (D:\\a\\1\\s\\node_modules\\mocha\\lib\\runner.js:425:5)\r\n2020-04-07T20:06:50.5430453Z     at processImmediate (internal/timers.js:456:21)\r\n2020-04-07T20:06:50.5787488Z npm ERR! code ELIFECYCLE\r\n2020-04-07T20:06:50.5789952Z npm ERR! errno 1\r\n2020-04-07T20:06:50.5797278Z npm ERR! commitizen@0.0.0-semantically-released test-actual: `mocha --reporter=mocha-multi-reporters --reporter-options configFile=./test/mochareporters.json test/tests/index.js`\r\n2020-04-07T20:06:50.5798260Z npm ERR! Exit status 1\r\n2020-04-07T20:06:50.5798894Z npm ERR! \r\n2020-04-07T20:06:50.5799540Z npm ERR! Failed at the commitizen@0.0.0-semantically-released test-actual script.\r\n2020-04-07T20:06:50.5800335Z npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\r\n2020-04-07T20:06:50.6132605Z \r\n2020-04-07T20:06:50.6133884Z npm ERR! A complete log of this run can be found in:\r\n2020-04-07T20:06:50.6134754Z npm ERR!     C:\\npm\\cache\\_logs\\2020-04-07T20_06_50_573Z-debug.log\r\n2020-04-07T20:06:50.6970361Z -------------------------|---------|----------|---------|---------|-----------------------\r\n2020-04-07T20:06:50.6972484Z File                     | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s     \r\n2020-04-07T20:06:50.6973616Z -------------------------|---------|----------|---------|---------|-----------------------\r\n2020-04-07T20:06:50.6981488Z All files                |   43.05 |    42.36 |   47.06 |   43.44 |                       \r\n2020-04-07T20:06:50.6983782Z  commitizen              |   52.04 |    47.37 |      50 |   52.04 |                       \r\n2020-04-07T20:06:50.6985292Z   adapter.js             |   82.86 |    51.61 |      80 |   82.86 | 81-90,133             \r\n2020-04-07T20:06:50.6986668Z   cache.js               |       0 |      100 |       0 |       0 | 14-40                 \r\n2020-04-07T20:06:50.6987820Z   commit.js              |       0 |        0 |       0 |       0 | 15-62                 \r\n2020-04-07T20:06:50.6989495Z   configLoader.js        |     100 |      100 |     100 |     100 |                       \r\n2020-04-07T20:06:50.6990310Z   init.js                |   76.92 |    64.52 |     100 |   76.92 | 81,97,107,110,113,124 \r\n2020-04-07T20:06:50.6991161Z   staging.js             |       0 |        0 |       0 |       0 | 9-17                  \r\n2020-04-07T20:06:50.6991927Z  common                  |   29.17 |    26.67 |   42.86 |   29.17 |                       \r\n2020-04-07T20:06:50.6992746Z   util.js                |   29.17 |    26.67 |   42.86 |   29.17 | 27-52,62,64,75-81     \r\n2020-04-07T20:06:50.6993577Z  configLoader            |    71.7 |       60 |      90 |    71.7 |                       \r\n2020-04-07T20:06:50.6994335Z   findup.js              |   83.33 |       75 |     100 |   83.33 | 31-32                 \r\n2020-04-07T20:06:50.6995114Z   getContent.js          |      75 |       60 |      80 |      75 | 24,36-41,53,60,78     \r\n2020-04-07T20:06:50.6997379Z   getNormalizedConfig.js |    37.5 |       50 |     100 |    37.5 | 13,17-25              \r\n2020-04-07T20:06:50.7002693Z   loader.js              |   77.78 |    66.67 |     100 |   77.78 | 26,40                 \r\n2020-04-07T20:06:50.7003533Z  git                     |       0 |        0 |       0 |       0 |                       \r\n2020-04-07T20:06:50.7004348Z   add.js                 |       0 |      100 |       0 |       0 | 10-19                 \r\n2020-04-07T20:06:50.7005123Z   commit.js              |       0 |        0 |       0 |       0 | 15-78                 \r\n2020-04-07T20:06:50.7005868Z   init.js                |       0 |      100 |       0 |       0 | 7-8                   \r\n2020-04-07T20:06:50.7006658Z   log.js                 |       0 |        0 |       0 |       0 | 9-16                  \r\n2020-04-07T20:06:50.7009700Z   whatChanged.js         |       0 |        0 |       0 |       0 | 9-16                  \r\n2020-04-07T20:06:50.7010952Z -------------------------|---------|----------|---------|---------|-----------------------\r\n2020-04-07T20:06:50.7123398Z npm ERR! Test failed.  See above for more details.\r\n2020-04-07T20:06:50.8345942Z ##[error]Cmd.exe exited with code '1'.\r\n2020-04-07T20:06:50.8714689Z ##[section]Finishing: CmdLine\r\n```",
  "user": {
    "gists_url": "https://api.github.com/users/jimthedev/gists{/gist_id}",
    "repos_url": "https://api.github.com/users/jimthedev/repos",
    "following_url": "https://api.github.com/users/jimthedev/following{/other_user}",
    "starred_url": "https://api.github.com/users/jimthedev/starred{/owner}{/repo}",
    "login": "jimthedev",
    "followers_url": "https://api.github.com/users/jimthedev/followers",
    "type": "User",
    "url": "https://api.github.com/users/jimthedev",
    "subscriptions_url": "https://api.github.com/users/jimthedev/subscriptions",
    "received_events_url": "https://api.github.com/users/jimthedev/received_events",
    "avatar_url": "https://avatars.githubusercontent.com/u/108938?v=4",
    "events_url": "https://api.github.com/users/jimthedev/events{/privacy}",
    "html_url": "https://github.com/jimthedev",
    "site_admin": false,
    "id": 108938,
    "gravatar_id": "",
    "node_id": "MDQ6VXNlcjEwODkzOA==",
    "organizations_url": "https://api.github.com/users/jimthedev/orgs"
  },
  "url": "https://api.github.com/repos/commitizen/cz-cli/issues/comments/610975934",
  "node_id": "MDEyOklzc3VlQ29tbWVudDYxMDk3NTkzNA=="
}