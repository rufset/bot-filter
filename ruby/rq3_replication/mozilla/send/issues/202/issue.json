{
  "_id": {
    "$oid": "6071d5c943dd71267de177ef"
  },
  "assignees": [
    {
      "gists_url": "https://api.github.com/users/clouserw/gists{/gist_id}",
      "repos_url": "https://api.github.com/users/clouserw/repos",
      "following_url": "https://api.github.com/users/clouserw/following{/other_user}",
      "starred_url": "https://api.github.com/users/clouserw/starred{/owner}{/repo}",
      "login": "clouserw",
      "followers_url": "https://api.github.com/users/clouserw/followers",
      "type": "User",
      "url": "https://api.github.com/users/clouserw",
      "subscriptions_url": "https://api.github.com/users/clouserw/subscriptions",
      "received_events_url": "https://api.github.com/users/clouserw/received_events",
      "avatar_url": "https://avatars.githubusercontent.com/u/80098?v=4",
      "events_url": "https://api.github.com/users/clouserw/events{/privacy}",
      "html_url": "https://github.com/clouserw",
      "site_admin": false,
      "id": 80098,
      "gravatar_id": "",
      "node_id": "MDQ6VXNlcjgwMDk4",
      "organizations_url": "https://api.github.com/users/clouserw/orgs"
    },
    {
      "gists_url": "https://api.github.com/users/jvehent/gists{/gist_id}",
      "repos_url": "https://api.github.com/users/jvehent/repos",
      "following_url": "https://api.github.com/users/jvehent/following{/other_user}",
      "starred_url": "https://api.github.com/users/jvehent/starred{/owner}{/repo}",
      "login": "jvehent",
      "followers_url": "https://api.github.com/users/jvehent/followers",
      "type": "User",
      "url": "https://api.github.com/users/jvehent",
      "subscriptions_url": "https://api.github.com/users/jvehent/subscriptions",
      "received_events_url": "https://api.github.com/users/jvehent/received_events",
      "avatar_url": "https://avatars.githubusercontent.com/u/415617?v=4",
      "events_url": "https://api.github.com/users/jvehent/events{/privacy}",
      "html_url": "https://github.com/jvehent",
      "site_admin": false,
      "id": 415617,
      "gravatar_id": "",
      "node_id": "MDQ6VXNlcjQxNTYxNw==",
      "organizations_url": "https://api.github.com/users/jvehent/orgs"
    }
  ],
  "created_at": "2017-07-15T19:34:08Z",
  "title": "Security Checklist",
  "body": "Risk Management\r\n---------------\r\n* [x] The service must have performed a Rapid Risk Assessment and have a Risk Record bug (**SVC-RRA**).\r\n \r\nInfrastructure rules\r\n--------------------\r\n \r\n* [x] Access and application logs must be archived for a minimum of 90 days\r\n* [x] Use [Modern](https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility) or [Intermediate](https://wiki.mozilla.org/Security/Server_Side_TLS#Intermediate_compatibility) TLS (**INFRA-TLS**)\r\n* [x] Set HSTS to 31536000 (1 year) (**INFRA-HSTS**)\r\n  * `strict-transport-security: max-age=31536000`\r\n* [x] Set HPKP to 5184000 (60 days) (**INFRA-HPKP**)\r\n  * `Public-Key-Pins: max-age=5184000; pin-sha256=\"WoiWRyIOVNa9ihaBciRSC7XHjliYS9VwUGOIud4PB18=\"; pin-sha256=\"r/mIkG3eEpVdm+u/ko/cwxzOMo1bk4TyHIlByibiA5E=\"; pin-sha256=\"YLh1dUR9y6Kja30RrAn7JKnbQG/uEtLMkBgFF2Fuihg=\"; pin-sha256=\"sRHdihwgkaib1P1gxX8HFszlD+7/gTfNvuAybgLPNis=\";`\r\n    * Start with max-age set to 5 minutes (`max-age=300`) and increase progressively\r\n    * The first two pins are for Digicert EV and DV roots, the last two are for Let's Encrypt X3 and X4 intermediates (LE is only used for backup)\r\n  * [x] If the service is not hosted under `services.mozilla.com`, it must be manually added to [Firefox's preloaded pins](https://dxr.mozilla.org/mozilla-central/source/security/manager/tools/PreloadedHPKPins.json#184).\r\n* If service has an admin panels, it must:\r\n  * [x] only be available behind Mozilla VPN (which provides MFA) (**INFRA-ADMINVPN**)\r\n  * [x] require LDAP authentication (**INFRA-ADMINLDAP**)\r\n  * [x] enforce a two-man rule on sensitive changes (**INFRA-2MANRULE**)\r\n \r\nCoding rules\r\n------------\r\n \r\nThe following rules apply to all web applications: api and websites.\r\n \r\n* [x] Sign all release tags, and maybe commits as well (**APP-COMMITSIG**)\r\n  * Developers should [configure git to sign all tags](http://micropipes.com/blog//2016/08/31/signing-your-commits-on-github-with-a-gpg-key/) and upload their PGP fingerprint to https://login.mozilla.com\r\n  * The signature verification will eventually become a requirement to shipping a release to staging & prod: the tag being deployed in the pipeline must have a matching tag in git signed by a project owner. This control is designed to reduce the risk of a 3rd party GitHub integration from compromising our source code.\r\n* [x] Publish detailed logs in [mozlog](https://github.com/mozilla-services/Dockerflow/blob/master/docs/mozlog.md) format (**APP-MOZLOG**)\r\n  * Business logic must be logged with app specific codes (errno)\r\n  * Access control failures must be logged at WARN level\r\n* [x] Must have a CSP with (**APP-CSP**)\r\n  * [x] a report-uri pointing to the service's own `/__cspreport__` endpoint\r\n  * [x] web APIs should set `default-src` to `none`, disallowing all content rendering\r\n  * [x] if default-src is not `self`, frame-src and object-src should be `none` or only allow specific origins\r\n  * [x] no use of unsafe-inline or unsafe-eval\r\n* [x] User data must be escaped for the right context prior to reflecting it (**APP-ESCAPE**)\r\n* [x] Web APIs must set a non-HTML content-type on all responses, including 300s, 400s and 500s (**APP-NOHTML**)\r\n* [x] <strike>All SQL queries must be parameterized, not concatenated (**APP-SQL**)</strike>\r\n* [x] Apply sensible limits to user inputs, see [input validation](https://wiki.mozilla.org/WebAppSec/Secure_Coding_Guidelines#Input_Validation) (**APP-INPUTVAL**)\r\n* [x] When managing permissions, make sure access controls are enforced server-side (**APP-ACL**)\r\n* [x] <strike>Set the Secure and HTTPOnly flags on [Cookies](https://wiki.mozilla.org/Security/Guidelines/Web_Security#Cookies), and use sensible Expiration (**APP-SECCOOKIE**)</strike>\r\n* Keep 3rd-party libraries up to date (**APP-DEPS**)\r\n  * [x] Use [NSP](https://nodesecurity.io/) or [GreenKeeper](https://greenkeeper.io/Greenkeeper) for NodeJS applications\r\n  * [x] <strike>For Python applications, enable pyup security updates:</strike>\r\n    * Add a pyup config to your repo (example config: https://github.com/mozilla-services/antenna/blob/master/.pyup.yml)\r\n    * Add https://github.com/mozsvcpyup as a collaborator to your repo\r\n    * Notify secops@mozilla.com to enable the integration in pyup\r\n    * Consider using pip --outdated or [requires.io](https://requires.io/) too\r\n* [x] If handling cryptographic keys, must have a mechanism to handle quarterly key rotations (**APP-KEYROT**)\r\n  * Keys used to sign sessions don't need a rotation mechanism if destroying all sessions is acceptable in case of emergency.\r\n* [x] <strike>Applications must use accounts with limited GRANTS when connecting to databases (**APP-DBPRIV**)</strike>\r\n  * In particular, applications **must not use admin or owner accounts**, to decrease the impact of a sql injection vulnerability.\r\n* [x] fork, exec, subprocess, child_process, etc. calls passing user input to a binary should be [sandboxed](https://github.com/mozilla-services/foxsec/blob/master/docs/sandbox.md)\r\n\r\n(edit) - crossed out N/A items",
  "labels_url": "https://api.github.com/repos/mozilla/send/issues/202/labels{/name}",
  "author_association": "NONE",
  "number": 202,
  "score": 1,
  "updated_at": "2017-07-25T01:59:29Z",
  "performed_via_github_app": null,
  "comments_url": "https://api.github.com/repos/mozilla/send/issues/202/comments",
  "active_lock_reason": null,
  "repository_url": "https://api.github.com/repos/mozilla/send",
  "id": 243195418,
  "state": "closed",
  "locked": true,
  "comments": 4,
  "closed_at": "2017-07-25T01:59:29Z",
  "url": "https://api.github.com/repos/mozilla/send/issues/202",
  "labels": [
    {
      "default": false,
      "color": "b60205",
      "name": "security",
      "description": null,
      "id": 625891230,
      "url": "https://api.github.com/repos/mozilla/send/labels/security",
      "node_id": "MDU6TGFiZWw2MjU4OTEyMzA="
    }
  ],
  "milestone": {
    "creator": {
      "gists_url": "https://api.github.com/users/dannycoates/gists{/gist_id}",
      "repos_url": "https://api.github.com/users/dannycoates/repos",
      "following_url": "https://api.github.com/users/dannycoates/following{/other_user}",
      "starred_url": "https://api.github.com/users/dannycoates/starred{/owner}{/repo}",
      "login": "dannycoates",
      "followers_url": "https://api.github.com/users/dannycoates/followers",
      "type": "User",
      "url": "https://api.github.com/users/dannycoates",
      "subscriptions_url": "https://api.github.com/users/dannycoates/subscriptions",
      "received_events_url": "https://api.github.com/users/dannycoates/received_events",
      "avatar_url": "https://avatars.githubusercontent.com/u/87619?v=4",
      "events_url": "https://api.github.com/users/dannycoates/events{/privacy}",
      "html_url": "https://github.com/dannycoates",
      "site_admin": false,
      "id": 87619,
      "gravatar_id": "",
      "node_id": "MDQ6VXNlcjg3NjE5",
      "organizations_url": "https://api.github.com/users/dannycoates/orgs"
    },
    "closed_at": "2017-07-28T16:01:10Z",
    "description": "Implement pre-planned improvements for V2. Monitor V1 release metrics and feedback to inform final design and features of V2.",
    "created_at": "2017-05-24T17:58:32Z",
    "title": "Dedicated Dingo",
    "closed_issues": 68,
    "url": "https://api.github.com/repos/mozilla/send/milestones/4",
    "due_on": "2017-07-27T07:00:00Z",
    "labels_url": "https://api.github.com/repos/mozilla/send/milestones/4/labels",
    "number": 4,
    "updated_at": "2017-07-28T16:01:10Z",
    "html_url": "https://github.com/mozilla/send/milestone/4",
    "id": 2541270,
    "state": "closed",
    "open_issues": 0,
    "node_id": "MDk6TWlsZXN0b25lMjU0MTI3MA=="
  },
  "events_url": "https://api.github.com/repos/mozilla/send/issues/202/events",
  "html_url": "https://github.com/mozilla/send/issues/202",
  "assignee": {
    "gists_url": "https://api.github.com/users/clouserw/gists{/gist_id}",
    "repos_url": "https://api.github.com/users/clouserw/repos",
    "following_url": "https://api.github.com/users/clouserw/following{/other_user}",
    "starred_url": "https://api.github.com/users/clouserw/starred{/owner}{/repo}",
    "login": "clouserw",
    "followers_url": "https://api.github.com/users/clouserw/followers",
    "type": "User",
    "url": "https://api.github.com/users/clouserw",
    "subscriptions_url": "https://api.github.com/users/clouserw/subscriptions",
    "received_events_url": "https://api.github.com/users/clouserw/received_events",
    "avatar_url": "https://avatars.githubusercontent.com/u/80098?v=4",
    "events_url": "https://api.github.com/users/clouserw/events{/privacy}",
    "html_url": "https://github.com/clouserw",
    "site_admin": false,
    "id": 80098,
    "gravatar_id": "",
    "node_id": "MDQ6VXNlcjgwMDk4",
    "organizations_url": "https://api.github.com/users/clouserw/orgs"
  },
  "user": {
    "gists_url": "https://api.github.com/users/jvehent/gists{/gist_id}",
    "repos_url": "https://api.github.com/users/jvehent/repos",
    "following_url": "https://api.github.com/users/jvehent/following{/other_user}",
    "starred_url": "https://api.github.com/users/jvehent/starred{/owner}{/repo}",
    "login": "jvehent",
    "followers_url": "https://api.github.com/users/jvehent/followers",
    "type": "User",
    "url": "https://api.github.com/users/jvehent",
    "subscriptions_url": "https://api.github.com/users/jvehent/subscriptions",
    "received_events_url": "https://api.github.com/users/jvehent/received_events",
    "avatar_url": "https://avatars.githubusercontent.com/u/415617?v=4",
    "events_url": "https://api.github.com/users/jvehent/events{/privacy}",
    "html_url": "https://github.com/jvehent",
    "site_admin": false,
    "id": 415617,
    "gravatar_id": "",
    "node_id": "MDQ6VXNlcjQxNTYxNw==",
    "organizations_url": "https://api.github.com/users/jvehent/orgs"
  },
  "node_id": "MDU6SXNzdWUyNDMxOTU0MTg="
}